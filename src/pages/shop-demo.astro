---
import MarketingLayout from '../layouts/MarketingLayout.astro';
import ModernCard from '../components/ui/ModernCard.astro';
import ModernButton from '../components/ui/ModernButton.astro';

import EcommerceShowcase from '../components/demo-lab/EcommerceShowcase';

import { withBasePath } from '../utils/helpers';

const pageTitle = 'Shop Demo';
const pageDescription =
  'A realistic e-commerce experience: search, filters, wishlist, compare, cart, promo codes, and a simulated checkout â€” isolated from the rest of the site.';
---

<MarketingLayout title={pageTitle} description={pageDescription}>
  <div class="mx-auto w-full max-w-[1200px] px-5 pt-16 sm:px-6 lg:px-8">
    <header class="space-y-6">
      <div
        class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-2 font-mono text-xs uppercase tracking-widest text-zinc-200"
      >
        <span class="h-2 w-2 rounded-full bg-accent-500" aria-hidden="true"
        ></span>
        Shop Demo
      </div>

      <h1
        class="font-display text-4xl font-bold tracking-tight text-white sm:text-5xl"
      >
        {pageTitle}
      </h1>

      <p
        class="max-w-[75ch] text-base leading-relaxed text-zinc-300 sm:text-lg"
      >
        {pageDescription}
      </p>

      <div class="flex flex-wrap gap-3">
        <ModernButton
          href={withBasePath('demo-lab/')}
          variant="secondary"
          rounded="sm"
        >
          Back to Demo Lab
        </ModernButton>
        <ModernButton href={withBasePath('/')} variant="outline" rounded="sm">
          Home
        </ModernButton>
      </div>

      <ModernCard className="p-6" variant="glass">
        <div
          class="flex flex-col gap-5 md:flex-row md:items-start md:justify-between"
        >
          <div class="space-y-2">
            <h2 class="font-display text-2xl font-semibold text-white">
              Safety Console
            </h2>
            <p class="max-w-[75ch] text-sm leading-relaxed text-zinc-300">
              Toggle pause/reduced-motion/perf mode. These settings apply via
              <code class="rounded bg-black/40 px-1 py-0.5">data-demo-*</code>
              attributes and are respected by the shopping demo.
            </p>
          </div>

          <div class="grid w-full gap-2 sm:grid-cols-3 md:w-auto">
            <button
              type="button"
              class="demo-toggle inline-flex h-11 items-center justify-center rounded-lg border border-white/10 bg-white/5 px-4 text-sm font-semibold text-white transition hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-accent-400"
              data-demo-toggle="paused"
              aria-pressed="false"
            >
              Pause
            </button>
            <button
              type="button"
              class="demo-toggle inline-flex h-11 items-center justify-center rounded-lg border border-white/10 bg-white/5 px-4 text-sm font-semibold text-white transition hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-accent-400"
              data-demo-toggle="reduced"
              aria-pressed="false"
            >
              Reduced motion
            </button>
            <button
              type="button"
              class="demo-toggle inline-flex h-11 items-center justify-center rounded-lg border border-white/10 bg-white/5 px-4 text-sm font-semibold text-white transition hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-accent-400"
              data-demo-toggle="perf"
              aria-pressed="false"
            >
              Perf mode
            </button>
          </div>
        </div>

        <noscript>
          <p
            class="mt-5 rounded-xl border border-white/10 bg-white/5 p-4 text-sm text-zinc-200"
          >
            JavaScript is disabled, so the Safety Console and shopping
            interactivity are inactive. You can still browse a static product
            grid.
          </p>
        </noscript>
      </ModernCard>
    </header>

    <section class="scroll-mt-24 pb-20 pt-10">
      <div class="demo-module" data-demo-module="ecommerce-showcase">
        <EcommerceShowcase client:visible />
      </div>
    </section>
  </div>
</MarketingLayout>

<style>
  .demo-module {
    content-visibility: auto;
    contain: layout paint style;
    contain-intrinsic-size: 900px;
  }

  .demo-module[data-demo-paused='true'] * {
    animation-play-state: paused !important;
  }

  html[data-demo-reduced-motion='true'] .demo-module *,
  .demo-module[data-demo-reduced-motion='true'] * {
    animation: none !important;
    transition: none !important;
  }
</style>

<script>
  import '../scripts/demo-lab';
</script>
